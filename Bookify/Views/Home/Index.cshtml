@model IEnumerable<BookForListVM>

@{
	ViewData["Title"] = "Home Page";
	var allGenres = (IEnumerable<Genre>)ViewBag.AllGenres;
	var shoppingCart = (ShoppingCart)ViewBag.ShoppingCart;
}

@section LoadCartItems {

	@foreach (var cartItem in shoppingCart.ShoppingCartItems)
	{

		<li class="cart-item">
			<div class="media">
				<div class="media-left">
					<a href="books-detail.html">
						<img alt="" class="media-object" src="@cartItem.PictureUrl">
					</a>
				</div>
				<div class="media-body">
					<h6 class="dz-title"><a href="books-detail.html" class="media-heading">@cartItem.Name</a></h6>
					<span class="dz-price">@cartItem.Price.ToString("C")</span>
					<span class="item-close">&times;</span>
				</div>
			</div>
		</li>
	}

	<li class="cart-item text-center">
		<h6 class="text-secondary">Total = @shoppingCart.ShoppingCartItems.Sum(x => x.Price * x.Quantity).ToString("C")</h6>
	</li>
	<li class="text-center d-flex">
		<a asp-action="Index" asp-controller="ShoppingCart"  class="btn btn-sm btn-primary me-2 btnhover w-100">View Cart</a>

		<a asp-action="PlaceOrder" asp-controller="Orders" asp-route-shoppingCartId="@shoppingCart.BasketId" class="btn btn-sm btn-outline-primary btnhover w-100">Place Order</a>
	</li>

}


 @section SelectGenre {
	<select class="default-select">
		<option value="@null">Category</option>

		@foreach (var item in allGenres)
		{
			<option class="categorySectionGenreName" value="@item.Id">@item.GenreName</option>
		}
	</select>
 }


<section class="content-inner-1 bg-grey reccomend">
	<div class="container">

		<div class="section-head text-center">
			<h2 class="title">Recommended For You</h2>
			<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris.</p>
		</div>

		<!-- Swiper -->
		<div class="swiper-container swiper-two">
			<div class="swiper-wrapper">

				@foreach (var book in Model)
				{
					<div class="swiper-slide" style="width: 210px; margin-right: 30px;">
						<div class="books-card style-1 wow fadeInUp" data-wow-delay="0.4s">
							<div class="dz-media">
								<img src="@book.PictureUrl" alt="@book.Title">
							</div>
							<div class="dz-content">
								<h4 class="title">@string.Join(' ', book.Title.Split(' ').Take(2)) ...</h4>
								<span class="price">@book.Price.ToString("C")</span>
								<form asp-action="AddToBasket" asp-controller="ShoppingCart" method="post">
									<input type="hidden" name="productId" value="@book.Id" />
									<input type="hidden" name="quantity" value="1" />
									<a class="btn btn-secondary btnhover btnhover2" role="button">
										<i class="flaticon-shopping-cart-1 m-r10"></i> Add to cart
									</a>
								</form>
							</div>
						</div>
					</div>
				}

			</div>
		</div>

	</div>
</section>





 @section FooterCategory {
	<!-- Footer Category -->
	<div class="footer-category" >
		<div class="container">
			<div class="category-toggle">
				<a href="javascript:void(0);" class="toggle-btn" id="allBooksCategories">Books categories</a>
				<div class="toggle-items row">
					<div class="footer-col-book">
						<ul>
							@foreach (var genre in allGenres)
							{
								<li><a asp-action="GetBooksWithRelatedGenre" asp-controller="Home" asp-route-id="@genre.Id"  >@genre.GenreName</a></li>
							}
						</ul>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- Footer Category End -->
 }

 @section Scripts {
	<!-- Initialize Swiper (Make sure this script is included at the end of your body) -->
	<script>
		var swiper = new Swiper('.swiper-two', {
			// Swiper parameters
			loop: true, // Enable looping
			slidesPerView: 4, // Adjust based on your design
			spaceBetween: 30, // Space between slides
			// Add other configurations as needed
		});



			const selectCategoryGenreName = document.querySelector('.default-select');
			selectCategoryGenreName.addEventListener('change', function() {
				console.log(this.value)
				const genreId = this.value;
						window.open(`/Home/GetBooksWithRelatedGenre/${genreId}`, '_self');
			})

	</script>

 }